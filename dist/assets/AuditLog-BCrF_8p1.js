/* empty css             */import{l as A}from"./admin-Bo33Owj6.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  *//* empty css               */import"./request-DHoSJWvM.js";/* empty css                  */import{a as x,B as R,o as _,c as f,b as s,e,w as t,l as V,aa as B,s as N,r as m,D as L,W as K,F as U,C as O,X as k,h as M,E as T,u as j,$ as F,p as G,x as o,ag as z,n as E,ah as J,_ as W}from"./index-Cj9AfTnA.js";const X={class:"flex items-center gap-4 flex-wrap"},Y={class:"count-badge ml-auto"},$={class:"cell-time"},q={class:"cell-secondary"},H={class:"cell-id"},P={class:"cell-secondary"},Q={class:"cell-trace"},Z=x({__name:"AuditLog",setup(y){const r=m(!1),d=m(""),i=m([]),b=[{label:"证书签发",value:"CERTIFICATE_ISSUED"},{label:"证书吊销",value:"CERTIFICATE_REVOKED"},{label:"KMC 密钥生成",value:"KMC_KEY_GENERATED"},{label:"KMC 分发创建",value:"KMC_DISTRIBUTION_CREATED"},{label:"Sidecar 对象失效",value:"SIDECAR_OBJECT_INVALIDATED"}];function g(l){return l?l.replace("T"," ").substring(0,19):"-"}function h(l){return l!=null&&l.includes("ISSUED")||l!=null&&l.includes("GENERATED")?"event-success":l!=null&&l.includes("REVOKED")||l!=null&&l.includes("INVALIDATED")?"event-danger":l!=null&&l.includes("DISTRIBUTION")?"event-warning":"event-info"}async function u(){r.value=!0;try{const l=await A(d.value||void 0);i.value=l??[]}catch{i.value=[]}finally{r.value=!1}}return R(()=>{u()}),(l,c)=>{const I=k,C=K,v=T,w=M,p=L,n=z,D=J,S=B;return _(),f("div",null,[c[2]||(c[2]=s("div",{class:"page-header"},[s("h2",null,"审计日志"),s("p",null,"查看系统操作审计记录，支持按事件类型筛选")],-1)),e(p,{class:"mb-4"},{default:t(()=>[s("div",X,[e(C,{modelValue:d.value,"onUpdate:modelValue":c[0]||(c[0]=a=>d.value=a),placeholder:"全部事件类型",clearable:"",class:"w-48",onChange:u},{default:t(()=>[(_(),f(U,null,O(b,a=>e(I,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(w,{type:"primary",onClick:u,loading:r.value},{default:t(()=>[e(v,{class:"mr-1"},{default:t(()=>[e(j(F))]),_:1}),c[1]||(c[1]=G(" 查询 ",-1))]),_:1},8,["loading"]),s("span",Y,"共 "+o(i.value.length)+" 条",1)])]),_:1}),V((_(),N(p,null,{default:t(()=>[e(D,{data:i.value,style:{width:"100%"},"max-height":"600","empty-text":"暂无审计记录"},{default:t(()=>[e(n,{prop:"eventTime",label:"时间",width:"180",sortable:""},{default:t(({row:a})=>[s("span",$,o(g(a.eventTime)),1)]),_:1}),e(n,{prop:"eventType",label:"事件类型",width:"220"},{default:t(({row:a})=>[s("span",{class:E(["event-badge",h(a.eventType)])},o(a.eventType),3)]),_:1}),e(n,{prop:"objectType",label:"对象类型",width:"140"},{default:t(({row:a})=>[s("span",q,o(a.objectType),1)]),_:1}),e(n,{prop:"objectId",label:"对象 ID","min-width":"180","show-overflow-tooltip":""},{default:t(({row:a})=>[s("code",H,o(a.objectId),1)]),_:1}),e(n,{prop:"result",label:"结果",width:"90",align:"center"},{default:t(({row:a})=>[s("span",{class:E(["result-dot",a.result==="SUCCESS"?"success":"fail"])},o(a.result==="SUCCESS"?"成功":"失败"),3)]),_:1}),e(n,{prop:"message",label:"描述","min-width":"160","show-overflow-tooltip":""},{default:t(({row:a})=>[s("span",P,o(a.message||"-"),1)]),_:1}),e(n,{prop:"traceId",label:"Trace ID",width:"160","show-overflow-tooltip":""},{default:t(({row:a})=>[s("code",Q,o(a.traceId||"-"),1)]),_:1})]),_:1},8,["data"])]),_:1})),[[S,r.value]])])}}}),il=W(Z,[["__scopeId","data-v-42dfccae"]]);export{il as default};
