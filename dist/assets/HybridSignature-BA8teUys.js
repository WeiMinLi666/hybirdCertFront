/* empty css             *//* empty css                             *//* empty css               */import"./request-DHoSJWvM.js";/* empty css                *//* empty css                  *//* empty css                  *//* empty css                  *//* empty css                 */import{a as L,o as S,c as q,b as n,e,w as t,s as R,y as D,r as b,D as H,K as Q,L as N,M as T,N as F,W as K,X as j,h as z,E as G,u as v,P as J,p as d,Q as O,J as W,j as X,x as y,R as h,f as Y,G as Z,U as P,I as $,_ as ee}from"./index-Cj9AfTnA.js";import{a as le}from"./enroll-osQp5diG.js";const te={class:"grid grid-cols-1 lg:grid-cols-2 gap-x-6"},ae={class:"grid grid-cols-1 lg:grid-cols-2 gap-x-6"},oe={class:"flex gap-2 w-full"},se={key:0,class:"mt-4"},re={class:"flex items-center justify-between mb-2"},ne={class:"pem-block"},ue=L({__name:"HybridSignature",setup(ie){const c=b(),f=b(!1),s=b(null),g=Y(()=>{var r;return(r=s.value)!=null&&r.message?s.value.message.replace(/\\n/g,`
`):""}),a=Z({principalCode:"",csrPem:"",pqcAlg:"ML-DSA-65",pqcPublicKeyBase64:"",pqcSignature:"",sm2Signature:"",nonce:""}),x={principalCode:[{required:!0,message:"必填",trigger:"blur"}],csrPem:[{required:!0,message:"必填",trigger:"blur"}],pqcAlg:[{required:!0,message:"请选择 PQC 算法",trigger:"change"}],pqcPublicKeyBase64:[{required:!0,message:"必填",trigger:"blur"}],pqcSignature:[{required:!0,message:"必填",trigger:"blur"}],sm2Signature:[{required:!0,message:"必填",trigger:"blur"}],nonce:[{required:!0,message:"必填",trigger:"blur"}]};function M(){const r=new Uint8Array(16);crypto.getRandomValues(r),a.nonce=Array.from(r,l=>l.toString(16).padStart(2,"0")).join("")}async function C(){var l;if(await((l=c.value)==null?void 0:l.validate().catch(()=>!1))){f.value=!0;try{s.value=await le({...a}),P.success("混合签名证书申请已提交！")}catch{}finally{f.value=!1}}}function w(){g.value&&(navigator.clipboard.writeText(g.value),P.success("已复制到剪贴板"))}function I(){var r;(r=c.value)==null||r.resetFields(),s.value=null}return(r,l)=>{const i=F,u=T,p=j,k=K,_=G,m=z,B=Q,E=H,V=X,A=W,U=$;return S(),q("div",null,[l[13]||(l[13]=n("div",{class:"page-header"},[n("h2",null,"混合签名证书申请"),n("p",null,"提交 SM2 CSR + PQC 签名数据，申请 SM2/PQC 双签名混合证书")],-1)),e(E,null,{default:t(()=>[e(B,{ref_key:"formRef",ref:c,model:a,rules:x,"label-position":"top",onSubmit:N(C,["prevent"])},{default:t(()=>[n("div",te,[e(u,{label:"申请主体编码",prop:"principalCode"},{default:t(()=>[e(i,{modelValue:a.principalCode,"onUpdate:modelValue":l[0]||(l[0]=o=>a.principalCode=o),placeholder:"设备/主体唯一编码"},null,8,["modelValue"])]),_:1}),e(u,{label:"PQC 算法",prop:"pqcAlg"},{default:t(()=>[e(k,{modelValue:a.pqcAlg,"onUpdate:modelValue":l[1]||(l[1]=o=>a.pqcAlg=o),placeholder:"选择后量子签名算法",class:"w-full"},{default:t(()=>[e(p,{label:"ML-DSA-44 (Dilithium2)",value:"ML-DSA-44"}),e(p,{label:"ML-DSA-65 (Dilithium3)",value:"ML-DSA-65"}),e(p,{label:"ML-DSA-87 (Dilithium5)",value:"ML-DSA-87"}),e(p,{label:"SLH-DSA-SHA2-128s",value:"SLH-DSA-SHA2-128s"}),e(p,{label:"SLH-DSA-SHA2-256f",value:"SLH-DSA-SHA2-256f"})]),_:1},8,["modelValue"])]),_:1})]),e(u,{label:"SM2 CSR (PEM 格式)",prop:"csrPem"},{default:t(()=>[e(i,{modelValue:a.csrPem,"onUpdate:modelValue":l[2]||(l[2]=o=>a.csrPem=o),type:"textarea",rows:6,placeholder:`-----BEGIN CERTIFICATE REQUEST-----
...
-----END CERTIFICATE REQUEST-----`},null,8,["modelValue"])]),_:1}),e(u,{label:"PQC 公钥 (Base64)",prop:"pqcPublicKeyBase64"},{default:t(()=>[e(i,{modelValue:a.pqcPublicKeyBase64,"onUpdate:modelValue":l[3]||(l[3]=o=>a.pqcPublicKeyBase64=o),type:"textarea",rows:4,placeholder:"后量子签名算法的公钥 Base64 编码"},null,8,["modelValue"])]),_:1}),n("div",ae,[e(u,{label:"SM2 签名",prop:"sm2Signature"},{default:t(()=>[e(i,{modelValue:a.sm2Signature,"onUpdate:modelValue":l[4]||(l[4]=o=>a.sm2Signature=o),type:"textarea",rows:3,placeholder:"对 CSR 内容的 SM2 签名值"},null,8,["modelValue"])]),_:1}),e(u,{label:"PQC 签名",prop:"pqcSignature"},{default:t(()=>[e(i,{modelValue:a.pqcSignature,"onUpdate:modelValue":l[5]||(l[5]=o=>a.pqcSignature=o),type:"textarea",rows:3,placeholder:"对 CSR 内容的 PQC 签名值"},null,8,["modelValue"])]),_:1})]),e(u,{label:"随机数 (Nonce)",prop:"nonce"},{default:t(()=>[n("div",oe,[e(i,{modelValue:a.nonce,"onUpdate:modelValue":l[6]||(l[6]=o=>a.nonce=o),placeholder:"防重放随机数"},null,8,["modelValue"]),e(m,{onClick:M,type:"info",plain:""},{default:t(()=>[e(_,{class:"mr-1"},{default:t(()=>[e(v(J))]),_:1}),l[7]||(l[7]=d(" 生成 ",-1))]),_:1})])]),_:1}),e(u,null,{default:t(()=>[e(m,{type:"primary",loading:f.value,onClick:C,size:"large"},{default:t(()=>[e(_,{class:"mr-1"},{default:t(()=>[e(v(O))]),_:1}),l[8]||(l[8]=d(" 提交混合签名申请 ",-1))]),_:1},8,["loading"]),e(m,{onClick:I,size:"large"},{default:t(()=>[...l[9]||(l[9]=[d("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),s.value?(S(),R(E,{key:0,class:"mt-6"},{header:t(()=>[...l[10]||(l[10]=[n("span",{class:"font-semibold"},"✅ 混合签名证书结果",-1)])]),default:t(()=>[e(U,{column:1,border:""},{default:t(()=>[e(A,{label:"请求 ID"},{default:t(()=>[e(V,{effect:"dark"},{default:t(()=>[d(y(s.value.requestId),1)]),_:1})]),_:1}),e(A,{label:"状态"},{default:t(()=>[e(V,{type:s.value.status==="ISSUED"?"success":"warning",effect:"dark"},{default:t(()=>[d(y(s.value.status),1)]),_:1},8,["type"])]),_:1})]),_:1}),s.value.message&&s.value.status==="ISSUED"?(S(),q("div",se,[n("div",re,[l[12]||(l[12]=n("span",{class:"text-sm font-medium text-slate-400"},"签发证书 PEM",-1)),e(m,{size:"small",text:"",onClick:w},{default:t(()=>[e(_,{class:"mr-1"},{default:t(()=>[e(v(h))]),_:1}),l[11]||(l[11]=d(" 复制 ",-1))]),_:1})]),n("pre",ne,y(g.value),1)])):D("",!0)]),_:1})):D("",!0)])}}}),Ce=ee(ue,[["__scopeId","data-v-c394260c"]]);export{Ce as default};
