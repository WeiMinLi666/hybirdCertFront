/* empty css             */import{g as K,u as q}from"./admin-Bo33Owj6.js";/* empty css                *//* empty css                  *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                 *//* empty css                 */import"./request-DHoSJWvM.js";import{a as H,B as Q,o as c,c as V,b as a,l as O,aa as U,s as L,w as t,e as l,r as v,D as B,G as T,x as r,ab as z,j as R,p as b,y as j,K as G,L as W,M as X,N as J,ac as Y,W as Z,ad as $,X as h,ae as ee,h as le,E as ae,u as x,af as te,P as se,U as oe,_ as ne}from"./index-Cj9AfTnA.js";const ie={class:"flex items-center justify-between"},de={key:0,class:"policy-info-grid"},ue={class:"policy-info-item"},re={class:"value"},ce={class:"policy-info-item"},pe={class:"value"},ve={class:"policy-info-item"},me={class:"alg-value"},fe={class:"policy-info-item"},ge={class:"alg-value"},_e={class:"policy-info-item"},Le={class:"alg-value level"},be={class:"policy-info-item"},Ee={class:"value text-slate-400 text-xs"},Se={class:"grid grid-cols-1 lg:grid-cols-2 gap-x-6"},ye={class:"grid grid-cols-1 lg:grid-cols-2 gap-x-6"},Ae={class:"grid grid-cols-1 lg:grid-cols-2 gap-x-6"},Me=H({__name:"PqcPolicy",setup(Ve){const E=v(),m=v(!1),f=v(!1),n=v(null),s=T({name:"",enabled:!0,pqcAlg:"",defaultSignAlg:"ML-DSA-65",defaultEncAlg:"ML-KEM-768",securityLevel:"LEVEL_3",version:1}),P={name:[{required:!0,message:"必填",trigger:"blur"}],defaultSignAlg:[{required:!0,message:"请选择默认签名算法",trigger:"change"}],defaultEncAlg:[{required:!0,message:"请选择默认加密算法",trigger:"change"}],securityLevel:[{required:!0,message:"请选择安全等级",trigger:"change"}]};async function g(){m.value=!0;try{const d=await K();n.value=d,d&&(s.defaultSignAlg=d.defaultSignAlg||"ML-DSA-65",s.defaultEncAlg=d.defaultEncAlg||"ML-KEM-768",s.securityLevel=d.securityLevel||"LEVEL_3",s.version=(d.version??0)+1)}catch{n.value=null}finally{m.value=!1}}async function S(){var e;if(await((e=E.value)==null?void 0:e.validate().catch(()=>!1))){f.value=!0;try{await q({...s}),oe.success("策略已保存"),await g()}catch{}finally{f.value=!1}}}return Q(()=>{g()}),(d,e)=>{const C=R,D=z,y=B,N=J,u=X,w=Y,o=h,p=$,_=Z,I=ee,A=ae,M=le,k=G,F=U;return c(),V("div",null,[e[21]||(e[21]=a("div",{class:"page-header"},[a("h2",null,"PQC 策略管理"),a("p",null,"查看当前生效策略，或新增策略版本来调整算法配置（新策略保存后立即生效）")],-1)),O((c(),L(y,{class:"mb-6"},{header:t(()=>[a("div",ie,[e[6]||(e[6]=a("span",{class:"font-semibold"},"当前生效策略",-1)),n.value?(c(),L(C,{key:0,type:n.value.enabled?"success":"danger",effect:"dark",size:"small"},{default:t(()=>[b(r(n.value.enabled?"已启用":"已禁用"),1)]),_:1},8,["type"])):j("",!0)])]),default:t(()=>[n.value?(c(),V("div",de,[a("div",ue,[e[7]||(e[7]=a("span",{class:"label"},"策略名称",-1)),a("span",re,r(n.value.name),1)]),a("div",ce,[e[8]||(e[8]=a("span",{class:"label"},"版本",-1)),a("span",pe,"v"+r(n.value.version),1)]),a("div",ve,[e[9]||(e[9]=a("span",{class:"label"},"默认签名算法",-1)),a("code",me,r(n.value.defaultSignAlg||"未设置"),1)]),a("div",fe,[e[10]||(e[10]=a("span",{class:"label"},"默认加密算法",-1)),a("code",ge,r(n.value.defaultEncAlg||"未设置"),1)]),a("div",_e,[e[11]||(e[11]=a("span",{class:"label"},"最低安全等级",-1)),a("code",Le,r(n.value.securityLevel),1)]),a("div",be,[e[12]||(e[12]=a("span",{class:"label"},"生效时间",-1)),a("span",Ee,r(n.value.effectiveFrom??"立即生效"),1)])])):(c(),L(D,{key:1,description:"暂无生效策略，请在下方创建第一条策略","image-size":60}))]),_:1})),[[F,m.value]]),l(y,null,{header:t(()=>[...e[13]||(e[13]=[a("span",{class:"font-semibold"},"新建策略版本",-1)])]),default:t(()=>[l(k,{ref_key:"formRef",ref:E,model:s,rules:P,"label-position":"top",onSubmit:W(S,["prevent"])},{default:t(()=>[a("div",Se,[l(u,{label:"策略名称",prop:"name"},{default:t(()=>[l(N,{modelValue:s.name,"onUpdate:modelValue":e[0]||(e[0]=i=>s.name=i),placeholder:"例：生产策略 v2"},null,8,["modelValue"])]),_:1}),l(u,{label:"策略版本号",prop:"version"},{default:t(()=>[l(w,{modelValue:s.version,"onUpdate:modelValue":e[1]||(e[1]=i=>s.version=i),min:1,class:"w-full"},null,8,["modelValue"])]),_:1})]),e[19]||(e[19]=a("div",{class:"section-label"},"算法配置",-1)),e[20]||(e[20]=a("p",{class:"section-desc"},"签发时若客户端未指定算法，自动使用下方策略默认值",-1)),a("div",ye,[l(u,{label:"默认签名算法（混合证书）",prop:"defaultSignAlg"},{default:t(()=>[l(_,{modelValue:s.defaultSignAlg,"onUpdate:modelValue":e[2]||(e[2]=i=>s.defaultSignAlg=i),placeholder:"选择 PQC 签名算法",class:"w-full"},{default:t(()=>[l(p,{label:"ML-DSA (Dilithium) — NIST FIPS 204"},{default:t(()=>[l(o,{label:"ML-DSA-44  (Level 2)",value:"ML-DSA-44"}),l(o,{label:"ML-DSA-65  (Level 3)",value:"ML-DSA-65"}),l(o,{label:"ML-DSA-87  (Level 5)",value:"ML-DSA-87"})]),_:1}),l(p,{label:"FALCON — NIST PQC Round 3"},{default:t(()=>[l(o,{label:"FALCON-512  (Level 1)",value:"FALCON-512"}),l(o,{label:"FALCON-1024 (Level 5)",value:"FALCON-1024"})]),_:1}),l(p,{label:"SLH-DSA (SPHINCS+) — NIST FIPS 205"},{default:t(()=>[l(o,{label:"SLH-DSA-128 (Level 1)",value:"SLH-DSA-128"}),l(o,{label:"SLH-DSA-192 (Level 3)",value:"SLH-DSA-192"}),l(o,{label:"SLH-DSA-256 (Level 5)",value:"SLH-DSA-256"})]),_:1})]),_:1},8,["modelValue"]),e[14]||(e[14]=a("div",{class:"text-xs text-slate-500 mt-1"},"用于混合签名证书（Hybrid）中的 PQC 签名验证",-1))]),_:1}),l(u,{label:"默认加密算法（加密证书）",prop:"defaultEncAlg"},{default:t(()=>[l(_,{modelValue:s.defaultEncAlg,"onUpdate:modelValue":e[3]||(e[3]=i=>s.defaultEncAlg=i),placeholder:"选择 PQC 加密算法",class:"w-full"},{default:t(()=>[l(p,{label:"ML-KEM (Kyber) — NIST FIPS 203"},{default:t(()=>[l(o,{label:"ML-KEM-512  (Level 1)",value:"ML-KEM-512"}),l(o,{label:"ML-KEM-768  (Level 3)",value:"ML-KEM-768"}),l(o,{label:"ML-KEM-1024 (Level 5)",value:"ML-KEM-1024"})]),_:1})]),_:1},8,["modelValue"]),e[15]||(e[15]=a("div",{class:"text-xs text-slate-500 mt-1"},"用于混合加密证书（Encryption）中的 PQC 密钥封装",-1))]),_:1})]),a("div",Ae,[l(u,{label:"最低安全等级（所有 PQC 算法的拒绝下限）",prop:"securityLevel"},{default:t(()=>[l(_,{modelValue:s.securityLevel,"onUpdate:modelValue":e[4]||(e[4]=i=>s.securityLevel=i),class:"w-full"},{default:t(()=>[l(o,{label:"Level 1 (AES-128 等效)",value:"LEVEL_1"}),l(o,{label:"Level 3 (AES-192 等效)",value:"LEVEL_3"}),l(o,{label:"Level 5 (AES-256 等效)",value:"LEVEL_5"})]),_:1},8,["modelValue"]),e[16]||(e[16]=a("div",{class:"text-xs text-slate-500 mt-1"},"低于此等级的 PQC 算法请求将被服务端拒绝",-1))]),_:1}),l(u,{label:"是否立即启用",prop:"enabled"},{default:t(()=>[l(I,{modelValue:s.enabled,"onUpdate:modelValue":e[5]||(e[5]=i=>s.enabled=i),"active-text":"保存后立即生效","inactive-text":"暂不启用","inline-prompt":"",size:"large"},null,8,["modelValue"])]),_:1})]),l(u,null,{default:t(()=>[l(M,{type:"primary",loading:f.value,onClick:S,size:"large"},{default:t(()=>[l(A,{class:"mr-1"},{default:t(()=>[l(x(te))]),_:1}),e[17]||(e[17]=b(" 保存新策略 ",-1))]),_:1},8,["loading"]),l(M,{onClick:g,size:"large"},{default:t(()=>[l(A,{class:"mr-1"},{default:t(()=>[l(x(se))]),_:1}),e[18]||(e[18]=b(" 刷新生效策略 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),He=ne(Me,[["__scopeId","data-v-016bd004"]]);export{He as default};
